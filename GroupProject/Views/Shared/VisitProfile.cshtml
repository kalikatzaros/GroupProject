@model GroupProject.ViewModels.ProfileViewModel

<h2>Profile</h2>

<div>

    <hr />
    <div class="PersonalInfo">

        <h4>Personal Info</h4>
        <img src="~/img/@Url.Content(Model.ProfileImage)" width="150" height="150" style="border-radius: 5px" />
        <p>First Name : @Model.FirstName</p>
        <p>Last Name : @Model.LastName</p>
        <p>E-mail : @Model.Email</p>
        <p>Date of Birth : @Model.DateOfBirth.ToString("dd/MM/yyyy")</p>

    </div>
    <h2>
        @Model.User.FullName
        @if (User.Identity.IsAuthenticated)
        {
            if (Model.IsFollowing)
            {
                <button class="btn btn-info ">Following</button>
            }
            else
            {
                <button class="btn btn-default">Follow</button>
            }
        }
    </h2>
    <ul>
        @foreach (var follower in Model.User.Followers)
        {
        <li>

            <div class="details">
                <span class="user">

                    @if (Model.ShowActions)
                    {
                        <button data-user-id="@Model.FullName"
                                class="btn btn-link
                                @(Model.Followings.Contains(Model.FullName) ? "following" : "follow")
                                btn-sm js-toggle-follow">
                            @(Model.Followings.Contains(Model.FullName) ? "following" : "follow")
                        </button>
                    }
                </span>
            </div>
        </li>
         }
</ul>
        <table class="table">
            <tr>
                <th>
                    @Html.DisplayName("My Posts")
                </th>
                <th></th>

            </tr>
            @if (Model.WallPosts.ToList().Count() < 1)
            {
                <tbody>
                    <tr>
                        <td>
                            No Posts yet....
                        </td>
                    </tr>

                </tbody>
            }

            @foreach (var item in Model.WallPosts)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.Post.Body)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Post.Datetime)
                    </td>

                </tr>
            }
        </table>
    </div>

@section scripts{
    <script>
        $(document).ready(function () {
            $(".js-toggle-follow").click(function (e) {
                var button = $(e.target);
                if (button.hasClass("follow")) {

                    $.post("/api/followings", { followeeId: button.attr("data-user-id") })
                        .done(function () {
                            button.text("Following");
                            location.reload();
                        })
                        .fail("Something failed");
                } else {
                    $.ajax({
                        url: "/api/followings/" + button.attr("data-user-id"),
                        method: "DELETE"
                    }).done(function () {
                        button.text("Follow");
                        location.reload();
                    }).fail(function () {
                        alert("Something failed!");
                    });
                }
            });
        });
    </script>

}


<style>
    .btn:hover {
        color: white;
        background-color: blue;
    }
</style>










